server {
    listen 80;
    listen [::]:80;

    # Use OpenResty's /etc/resolv.conf parsing capability.
    # This however does not include the 'search' directives
    # but only the 'nameserver' ones (it seems).
    # See: https://groups.google.com/g/openresty-en/c/jIrpyTYgSVA
    resolver local=on;

    location / {
        proxy_pass http://$http_host$uri$is_args$args;
        access_by_lua_file /app/access.lua;
    }
}
